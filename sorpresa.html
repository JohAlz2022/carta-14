<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Sorpresa ‚ù£Ô∏è</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body class="fade-in">
  <div class="bg"></div>
  <div class="hearts"></div>
  <div class="confetti" id="confetti"></div>

  <audio id="bgm" preload="auto" loop>
    <source src="audio/uwaie.mp3" type="audio/mpeg">
    <!-- Alternativa si no renombraste:
    <source src="audio/UWAIE%20-%20Kapo%20%28Video%20Oficial%29.mp3" type="audio/mpeg">
    -->
  </audio>

  <main class="page">
    <div class="container">
      <section class="card">
        <p class="mini">Sorpresa ‚ù£Ô∏è</p>
        <h1>Te pienso m√°s de lo que crees</h1>
        <p>y aunque est√©s lejos, quer√≠a estar cerquita de alguna forma mi amor.</p>

        <div class="letter">
          <p>
            Hola preciosa ‚ù£Ô∏è<br><br>
            (Aqu√≠ escribe tu carta. Si quieres, p√©gamela y te la dejo perfecta.)<br><br>
            Me encantan tus fotos, tu sonrisa‚Ä¶ y s√≠, est√°s hermosa.
            Me haces sentir bonito incluso a la distancia.<br><br>
            Y por eso quer√≠a preguntarte algo simple‚Ä¶
          </p>
        </div>

        <div class="row" style="margin-top:18px;">
          <button class="btn primary pulse" id="btnAsk">¬øQuieres ser mi 14 de febrero? üíò</button>
        </div>

        <div class="row" style="margin-top:12px;">
          <button class="btn" onclick="pageGo('recuerdos.html')">Ver recuerdos üì∏</button>
          <button class="btn" onclick="pageGo('index.html')">Volver ‚Ü©Ô∏è</button>
        </div>

        <div class="reveal" id="reveal" aria-hidden="true">
          <p class="big">üíû Entonces queda as√≠: t√∫ y yo, este 14.</p>
          <p class="small">PD: cuando regreses, te debo una cita como se debe.</p>

          <!-- CAMBIA TU N√öMERO -->
          <div class="row" style="margin-top:12px;">
            <a class="btn primary" target="_blank" rel="noopener"
              href="https://wa.me/51990367042?text=S√≠%20üíò%20acepto%20ser%20tu%2014%20de%20febrero">
              Decirte que S√ç por WhatsApp üí¨
            </a>
          </div>
        </div>

      </section>
    </div>
  </main>

  <div class="player">
    <button class="btn primary" id="playBtn">‚ñ∂</button>
    <small>UWAIE - Kapo</small>
  </div>

  <script>
    function pageGo(url){
      document.body.classList.add('fade-out');
      setTimeout(()=> location.href = url, 240);
    }

    // ===== Audio persistente =====
    const audio = document.getElementById('bgm');
    const playBtn = document.getElementById('playBtn');

    const savedTime = Number(localStorage.getItem('bgm_time') || 0);
    const savedPlay = localStorage.getItem('bgm_play') === '1';
    if (!Number.isNaN(savedTime) && savedTime > 0) audio.currentTime = Math.min(savedTime, Math.max(0, audio.duration || savedTime));

    function setUI(playing){ playBtn.textContent = playing ? '‚è∏' : '‚ñ∂'; }

    async function startMusic(){
      try{ await audio.play(); localStorage.setItem('bgm_play','1'); setUI(true); }
      catch(e){ setUI(false); }
    }
    function pauseMusic(){ audio.pause(); localStorage.setItem('bgm_play','0'); setUI(false); }

    if(savedPlay) startMusic(); else setUI(false);
    setInterval(()=> localStorage.setItem('bgm_time', String(audio.currentTime || 0)), 800);

    playBtn.addEventListener('click', ()=> audio.paused ? startMusic() : pauseMusic());
    window.addEventListener('pointerdown', ()=> {
      if(localStorage.getItem('bgm_play') === '1' && audio.paused) startMusic();
    }, { once:false });

    // ===== Confeti + corazones =====
    function launchConfetti(){
      const wrap = document.getElementById('confetti');
      wrap.innerHTML = '';
      const n = 95;
      for(let k=0;k<n;k++){
        const p = document.createElement('i');
        p.style.left = Math.random()*100 + 'vw';
        p.style.animationDelay = (Math.random()*0.35) + 's';
        p.style.background = `hsl(${Math.floor(Math.random()*30)+330}, 90%, 70%)`; // rosado/nude
        p.style.width = (8 + Math.random()*6) + 'px';
        p.style.height = (10 + Math.random()*10) + 'px';
        wrap.appendChild(p);
      }
      setTimeout(()=> wrap.innerHTML='', 2200);
    }

    function floatHearts(){
      const times = 14;
      for(let i=0;i<times;i++){
        setTimeout(()=>{
          const h = document.createElement('div');
          h.className = 'float-heart';
          h.textContent = '‚ù§';
          h.style.left = (10 + Math.random()*80) + 'vw';
          h.style.fontSize = (16 + Math.random()*22) + 'px';
          document.body.appendChild(h);
          setTimeout(()=> h.remove(), 1800);
        }, i*110);
      }
    }

    const btnAsk = document.getElementById('btnAsk');
    const reveal = document.getElementById('reveal');

    btnAsk.addEventListener('click', async ()=>{
      if(audio.paused) await startMusic();
      launchConfetti();
      floatHearts();
      reveal.classList.add('show');
      reveal.setAttribute('aria-hidden','false');
      if(navigator.vibrate) navigator.vibrate([30,20,30]);
    });
  </script>
</body>
</html>
