<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>Sorpresa ‚ú®</title>
  <link rel="stylesheet" href="styles.css" />

  <!-- Peque√±os overrides por si tu CSS qued√≥ duplicado -->
  <style>
    /* Asegura que el fondo cubra todo */
    html, body { min-height: 100%; }
    body { overflow-x: hidden; }

    /* Player SIEMPRE abajo-derecha */
    .player{
      position: fixed !important;
      right: 14px !important;
      bottom: 14px !important;
      left: auto !important;
      top: auto !important;
      transform: none !important;
      z-index: 999999 !important;
    }

    /* Bot√≥n principal m√°s grande */
    .btn.big{
      min-width: min(560px, 92vw) !important;
      padding: 16px 18px !important;
      font-size: 18px !important;
      border-radius: 18px !important;
    }

    /* Evita que el player tape contenido en m√≥vil */
    .page{ padding-bottom: 120px !important; }
  </style>
</head>

<body class="fade-in">
  <div class="bg"></div>
  <div class="hearts"></div>
  <div class="heart-burst" id="burst"></div>

  <!-- M√∫sica (2 sources: tu nombre largo + fallback) -->
  <audio id="bgm" preload="auto" loop playsinline>
    <source src="UWAIE%20-%20Kapo%20%28Video%20Oficial%29.mp3" type="audio/mpeg">
    <source src="audio/uwaie.mp3" type="audio/mpeg">
  </audio>

  <main class="page">
    <div class="container">
      <section class="card">
        <p class="mini">Sorpresa ‚ú®</p>

        <h1>Te pienso m√°s de lo que crees</h1>
        <p>y aunque est√©s lejos, quer√≠a estar cerquita de alguna forma.</p>

        <div class="letter">
          <p style="margin:0; color: rgba(42,28,34,.86); font-weight:800;">
            Hola preciosa ü§ç‚ù£Ô∏è
          </p>
          <p style="margin:10px 0 0;">
            Para comenzar este peque√±o detalle mi amor que espero te guste y te haya sorprendido al menos,
            quiero que sepas que te amo mucho. S√© que nuestra historia juntos acaba de comenzar y no llevamos
            mucho tiempo conoci√©ndonos como pareja‚Ä¶ aun as√≠ siento que te conozco bien amor, conf√≠o en ti y
            puedo entregarme a ti mi amor.
          </p>
          <p style="margin:10px 0 0;">
            Tal vez yo no sea el chico m√°s rom√°ntico o detallista, trato de mejorar eso mi amor por ti.
            Quiero que te sientas valorada y amada por m√≠. Quiero que a pesar de todo tu pasado (tal vez te fallaron,
            igual que a m√≠) no sientas que yo te har√© lo mismo mi amor, quiero que conf√≠es en m√≠.
          </p>
          <p style="margin:10px 0 0;">
            Tambi√©n quiero estar juntos para ver nuestros logros juntos, vivir muchas experiencias, viajar,
            salir, comer, bailar, tomar algo‚Ä¶ as√≠ sea lo que sea, pero estar juntos.
          </p>
          <p style="margin:10px 0 0;">
            S√© que no te esperabas que sucediera lo de nosotros, igual que yo, pero es la cosa m√°s bonita que me pas√≥.
            Espero que sea el tuyo tambi√©n amor.
          </p>
          <p style="margin:10px 0 0;">
            Tal vez este viaje al comienzo de nuestra historia es un reto fuerte, porque por lo general al comienzo
            de una relaci√≥n es estar siempre juntos y conocernos, pero a pesar de eso no quita el hecho de que
            yo me enamor√© cada d√≠a m√°s de ti.
          </p>
          <p style="margin:10px 0 0;">
            Y si superamos esto (y lo tomo por hecho), s√© que estaremos juntos toda la vida. Quiero que te diviertas,
            te relajes y me extra√±es mucho mi amor‚Ä¶ porque yo s√≠ te extra√±o mucho.
          </p>
          <p style="margin:10px 0 0;">
            Quer√≠a que tengas algo bonito para este 14, porque es nuestro primer 14. Te lo mandar√© d√≠as antes
            porque quer√≠a saber‚Ä¶
          </p>
          <p style="margin:12px 0 0; font-weight:900; color: rgba(42,28,34,.88);">
            Y por eso quer√≠a preguntarte algo simple‚Ä¶
          </p>
        </div>

        <div class="stack">
          <button class="btn primary pulse big" id="btnAsk">¬øQuieres ser mi 14 de febrero? üíò</button>
          <button class="btn" id="goRecuerdos">Recuerdos üì∏</button>
          <button class="btn" id="goVolver">Volver ‚Ü©Ô∏è</button>
        </div>

        <div class="reveal" id="reveal" aria-hidden="true">
          <p class="bigTitle">‚ú® Gracias mi amor por aceptarme üíó</p>
          <p class="bigText">
            Aunque sea a la distancia, mi amor, t√∫ sabes que siempre te voy a amar.
            Gracias por darme la oportunidad de vivir este 14 contigo.<br><br>
            S√© que ahora ser√° diferente‚Ä¶ pero m√°s adelante lo celebraremos como se debe juntos mi amor.<br>
            <b>PD:</b> llegando, nuestra cita queda pendiente mi amor. üíó
          </p>

          <div class="row" style="margin-top:14px;">
            <a class="btn primary" target="_blank" rel="noopener"
              href="https://wa.me/51990367042?text=Mi%20amor%20%C2%A1s%C3%AD%20acepto!%20%F0%9F%92%97%20Quiero%20ser%20tu%2014%20de%20febrero%20%F0%9F%92%98">
              Decirte que S√ç por WhatsApp üí¨
            </a>
          </div>
        </div>
      </section>
    </div>
  </main>

  <!-- Player fijo (abajo-derecha por CSS) -->
  <div class="player">
    <button class="btn primary" id="playBtn" type="button">‚ñ∂</button>
    <small>UWAIE - Kapo</small>
  </div>

  <div class="toast" id="toast">Toca ‚ñ∂ para activar la m√∫sica üéß</div>

  <script>
    // Fade navigation
    function pageGo(url){
      saveAudioState();
      document.body.classList.add('fade-out');
      setTimeout(()=> location.href = url, 240);
    }
    document.getElementById('goRecuerdos').addEventListener('click', ()=> pageGo('recuerdos.html'));
    document.getElementById('goVolver').addEventListener('click', ()=> pageGo('index.html'));

    // Hearts burst (muchos corazones)
    function heartsBurst(){
      const wrap = document.getElementById('burst');
      wrap.innerHTML = '';
      const hearts = ['üíó','üíñ','üíò','‚ù§Ô∏è','üíï'];
      const n = 160;
      for(let i=0;i<n;i++){
        const h = document.createElement('i');
        h.textContent = hearts[(Math.random()*hearts.length)|0];
        h.style.left = (Math.random()*100) + 'vw';
        h.style.fontSize = (14 + Math.random()*28) + 'px';
        h.style.animationDelay = (Math.random()*0.25) + 's';
        h.style.opacity = (0.65 + Math.random()*0.35).toFixed(2);
        wrap.appendChild(h);
      }
      setTimeout(()=> wrap.innerHTML='', 2200);
    }

    const btnAsk = document.getElementById('btnAsk');
    const reveal = document.getElementById('reveal');
    btnAsk.addEventListener('click', ()=>{
      heartsBurst();
      reveal.classList.add('show');
      reveal.setAttribute('aria-hidden','false');
      if(navigator.vibrate) navigator.vibrate([30,20,30]);
    });

    // ===== Audio persistente =====
    const bgm = document.getElementById('bgm');
    const playBtn = document.getElementById('playBtn');
    const toast = document.getElementById('toast');

    function showToast(msg){
      toast.textContent = msg;
      toast.classList.add('show');
      setTimeout(()=> toast.classList.remove('show'), 1800);
    }

    function setBtn(isPlaying){
      playBtn.textContent = isPlaying ? '‚è∏' : '‚ñ∂';
      playBtn.setAttribute('aria-pressed', String(isPlaying));
    }

    function saveAudioState(){
      try{
        localStorage.setItem('bgm_time', String(bgm.currentTime || 0));
        localStorage.setItem('bgm_playing', bgm.paused ? '0' : '1');
      }catch(e){}
    }

    async function tryResume(){
      // intenta restaurar estado
      let t = 0, shouldPlay = false;
      try{
        t = parseFloat(localStorage.getItem('bgm_time') || '0') || 0;
        shouldPlay = (localStorage.getItem('bgm_playing') === '1');
      }catch(e){}

      if (t > 0 && Number.isFinite(t)) {
        try { bgm.currentTime = t; } catch(e){}
      }

      if(shouldPlay){
        try{
          await bgm.play();
          setBtn(true);
        }catch(e){
          setBtn(false);
          showToast('Toca ‚ñ∂ para activar la m√∫sica üéß');
        }
      }else{
        setBtn(false);
      }
    }

    playBtn.addEventListener('click', async ()=>{
      try{
        if(bgm.paused){
          await bgm.play();
          setBtn(true);
          try{ localStorage.setItem('bgm_playing','1'); }catch(e){}
        }else{
          bgm.pause();
          setBtn(false);
          try{ localStorage.setItem('bgm_playing','0'); }catch(e){}
        }
      }catch(e){
        showToast('Tu navegador bloque√≥ el audio. Toca ‚ñ∂ otra vez.');
      }
      saveAudioState();
    });

    window.addEventListener('beforeunload', saveAudioState);
    document.addEventListener('visibilitychange', ()=>{ if(document.hidden) saveAudioState(); });

    // restore on load
    tryResume();
  </script>
</body>
</html>
